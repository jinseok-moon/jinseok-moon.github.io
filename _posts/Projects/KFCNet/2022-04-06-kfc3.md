---
title: "KFCNet 03 - 네트워크 모델링하기"
excerpt: "Korean Food Classifier Network - 03"

categories:
  - KFCNet
tags: 
  - [Convolutional Neural Network, Deep Learning, KFCNet]
toc: true
toc_sticky: true
toc_label: "On this page"
published: false

date: 2022-04-06
last_modified_at: 2022-04-19
---

## 네트워크 모델링
데이터셋을 준비했으니, 이제는 네트워크를 짜야한다. 하지만 바닥부터 모든것을 짜기에는 학습이 잘 될지 모르고, 어려움이 많다. 이럴때는 미리 학습된 다양한 모델들을 찾아보는게 좋다. 핫한 CV 분야답게 수많은 오픈소스가 존재하고, 그중에서 ResNet50을 선택했다. 
Pytorch는 간편하게 전이학습 (Transfer Learning)을 지원하고, 다음과 같이 사용한다. 클래스 생성시에 기존의 resnet과는 class의 개수가 다르기 때문에, 그 부분을 고쳐줘야한다. 즉 Fully Connected Network의 출력 부분을 수정하면 된다.

```python
from torch import nn
import torchvision.models as models


class KFCNet(nn.Module):
  def __init__(self, num_classes):
      super(KFCNet, self).__init__()

      self.model = models.resnet50(pretrained=True)  # For transfer learning

      in_feat = self.model.fc.in_features
      self.fc = nn.Linear(in_feat, num_classes)  # Change output classes of fcn

  def forward(self, x):
      return self.model(x)
```

